#ifndef __UTIL_MIME_H
#define __UTIL_MIME_H

/*!
 * \file mime.cc
 * \brief MIME/Type informations
 * \author Gr√©goire Lejeune
 * \version 0.1
 * \date January 2007
 */
#include <iostream>
#include <map>
#include <vector>
#include <utility>
#include "util/singleton.h"

#define DEFAULT_TYPE_EXTENSION "txt"

/*! \namespace lhs
 * 
 * Root namespace for all lhs specifics functions ans classes
 */
namespace lhs {
  /*! \namespace lhs::http
   *
   * Namespace for lhs util tools
   */ 
  namespace http {
    enum mime_type_value {
      APPLICATION_ACCESS,
      APPLICATION_ATOM_XML,
      APPLICATION_BLEEPER,
      APPLICATION_EXCEL,
      APPLICATION_FONT_TDPFR,
      APPLICATION_FUTURESPLASH,
      APPLICATION_HEP,
      APPLICATION_HYPERSTUDIO,
      APPLICATION_IMAGEMAP,
      APPLICATION_JAVASCRIPT,
      APPLICATION_JSON,
      APPLICATION_LOTUS_123,
      APPLICATION_MAC_BINHEX40,
      APPLICATION_MAC_COMPACTPRO,
      APPLICATION_MATHCAD,
      APPLICATION_MP4,
      APPLICATION_MSWORD,
      APPLICATION_NETCDF,
      APPLICATION_OCTET_STREAM,
      APPLICATION_ODA,
      APPLICATION_OGG,
      APPLICATION_PDF,
      APPLICATION_PGP_SIGNATURE,
      APPLICATION_PKCS10,
      APPLICATION_PKCS7_MIME,
      APPLICATION_PKCS7_SIGNATURE,
      APPLICATION_PKIXCMP,
      APPLICATION_PKIX_CERT,
      APPLICATION_PKIX_CRL,
      APPLICATION_PKIX_PKIPATH,
      APPLICATION_POSTSCRIPT,
      APPLICATION_POWERPOINT,
      APPLICATION_PRS_CWW,
      APPLICATION_PRS_NPREND,
      APPLICATION_QUICKTIMEPLAYER,
      APPLICATION_RDF_XML,
      APPLICATION_RTF,
      APPLICATION_SGML,
      APPLICATION_SGML_OPEN_CATALOG,
      APPLICATION_SIEVE,
      APPLICATION_SMIL,
      APPLICATION_SMIL_XML,
      APPLICATION_TOOLBOOK,
      APPLICATION_VMSBACKUP,
      APPLICATION_VND_3GPP_PIC_BW_LARGE,
      APPLICATION_VND_3GPP_PIC_BW_SMALL,
      APPLICATION_VND_3GPP_PIC_BW_VAR,
      APPLICATION_VND_3GPP_SMS,
      APPLICATION_VND_ACUCORP,
      APPLICATION_VND_ADOBE_XFDF,
      APPLICATION_VND_AMIGA_AMI,
      APPLICATION_VND_BLUEICE_MULTIPASS,
      APPLICATION_VND_CINDERELLA,
      APPLICATION_VND_COSMOCALLER,
      APPLICATION_VND_CRITICALTOOLS_WBS_XML,
      APPLICATION_VND_CURL,
      APPLICATION_VND_DATA_VISION_RDZ,
      APPLICATION_VND_DREAMFACTORY,
      APPLICATION_VND_FRAMEMAKER,
      APPLICATION_VND_FSC_WEBLAUNCH,
      APPLICATION_VND_GENOMATIX_TUXEDO,
      APPLICATION_VND_GOOGLE_EARTH_KML_XML,
      APPLICATION_VND_GOOGLE_EARTH_KMZ,
      APPLICATION_VND_HBCI,
      APPLICATION_VND_HHE_LESSON_PLAYER,
      APPLICATION_VND_HP_HPGL,
      APPLICATION_VND_IBM_ELECTRONIC_MEDIA,
      APPLICATION_VND_IBM_RIGHTS_MANAGEMENT,
      APPLICATION_VND_IBM_SECURE_CONTAINER,
      APPLICATION_VND_IPUNPLUGGED_RCPROFILE,
      APPLICATION_VND_IREPOSITORY_PACKAGE_XML,
      APPLICATION_VND_JISP,
      APPLICATION_VND_KDE_KARBON,
      APPLICATION_VND_KDE_KCHART,
      APPLICATION_VND_KDE_KFORMULA,
      APPLICATION_VND_KDE_KIVIO,
      APPLICATION_VND_KDE_KONTOUR,
      APPLICATION_VND_KDE_KPRESENTER,
      APPLICATION_VND_KDE_KSPREAD,
      APPLICATION_VND_KDE_KWORD,
      APPLICATION_VND_KENAMEAAPP,
      APPLICATION_VND_KIDSPIRATION,
      APPLICATION_VND_KINAR,
      APPLICATION_VND_LLAMAGRAPHICS_LIFE_BALANCE_DESKTOP,
      APPLICATION_VND_LLAMAGRAPHICS_LIFE_BALANCE_EXCHANGE_XML,
      APPLICATION_VND_LOTUS_1_2_3,
      APPLICATION_VND_MCD,
      APPLICATION_VND_MFMP,
      APPLICATION_VND_MICROGRAFX_FLO,
      APPLICATION_VND_MICROGRAFX_IGX,
      APPLICATION_VND_MIF,
      APPLICATION_VND_MOPHUN_APPLICATION,
      APPLICATION_VND_MOPHUN_CERTIFICATE,
      APPLICATION_VND_MOZILLA_XUL_XML,
      APPLICATION_VND_MSEQ,
      APPLICATION_VND_MS_ARTGALRY,
      APPLICATION_VND_MS_ASF,
      APPLICATION_VND_MS_CAB_COMPRESSED,
      APPLICATION_VND_MS_EXCEL,
      APPLICATION_VND_MS_EXCEL_SHEET_BINARY_MACROENABLED_12,
      APPLICATION_VND_MS_EXCEL_SHEET_MACROENABLED_12,
      APPLICATION_VND_MS_LRM,
      APPLICATION_VND_MS_POWERPOINT,
      APPLICATION_VND_MS_POWERPOINT_SLIDE_MACROENABLED_12,
      APPLICATION_VND_MS_POWERPOINT_TEMPLATE_MACROENABLED_12,
      APPLICATION_VND_MS_PROJECT,
      APPLICATION_VND_MS_WORD_DOCUMENT_MACROENABLED_12,
      APPLICATION_VND_MS_WORD_TEMPLATE_MACROENABLED_12,
      APPLICATION_VND_MS_WPL,
      APPLICATION_VND_MS_XPSDOCUMENT,
      APPLICATION_VND_NERVANA,
      APPLICATION_VND_NOKIA_RADIO_PRESET,
      APPLICATION_VND_NOKIA_RADIO_PRESETS,
      APPLICATION_VND_OASIS_OPENDOCUMENT_CHART,
      APPLICATION_VND_OASIS_OPENDOCUMENT_CHART_TEMPLATE,
      APPLICATION_VND_OASIS_OPENDOCUMENT_DATABASE,
      APPLICATION_VND_OASIS_OPENDOCUMENT_FORMULA,
      APPLICATION_VND_OASIS_OPENDOCUMENT_FORMULA_TEMPLATE,
      APPLICATION_VND_OASIS_OPENDOCUMENT_GRAPHICS,
      APPLICATION_VND_OASIS_OPENDOCUMENT_GRAPHICS_TEMPLATE,
      APPLICATION_VND_OASIS_OPENDOCUMENT_IMAGE,
      APPLICATION_VND_OASIS_OPENDOCUMENT_IMAGE_TEMPLATE,
      APPLICATION_VND_OASIS_OPENDOCUMENT_PRESENTATION,
      APPLICATION_VND_OASIS_OPENDOCUMENT_PRESENTATION_TEMPLATE,
      APPLICATION_VND_OASIS_OPENDOCUMENT_SPREADSHEET,
      APPLICATION_VND_OASIS_OPENDOCUMENT_SPREADSHEET_TEMPLATE,
      APPLICATION_VND_OASIS_OPENDOCUMENT_TEXT,
      APPLICATION_VND_OASIS_OPENDOCUMENT_TEXT_MASTER,
      APPLICATION_VND_OASIS_OPENDOCUMENT_TEXT_TEMPLATE,
      APPLICATION_VND_OASIS_OPENDOCUMENT_TEXT_WEB,
      APPLICATION_VND_OPENXMLFORMATS_OFFICEDOCUMENT_PRESENTATIONML_PRESENTATION,
      APPLICATION_VND_OPENXMLFORMATS_OFFICEDOCUMENT_PRESENTATIONML_SLIDESHOW,
      APPLICATION_VND_OPENXMLFORMATS_OFFICEDOCUMENT_PRESENTATIONML_TEMPLATE,
      APPLICATION_VND_OPENXMLFORMATS_OFFICEDOCUMENT_SPREADSHEETML_SHEET,
      APPLICATION_VND_OPENXMLFORMATS_OFFICEDOCUMENT_WORDPROCESSINGML_DOCUMENT,
      APPLICATION_VND_OPENXMLFORMATS_OFFICEDOCUMENT_WORDPROCESSINGML_TEMPLATE,
      APPLICATION_VND_PALM,
      APPLICATION_VND_PICSEL,
      APPLICATION_VND_PVI_PTID1,
      APPLICATION_VND_QUARK_QUARKXPRESS,
      APPLICATION_VND_SEALEDMEDIA_SOFTSEAL_HTML,
      APPLICATION_VND_SEALEDMEDIA_SOFTSEAL_PDF,
      APPLICATION_VND_SEALED_DOC,
      APPLICATION_VND_SEALED_EML,
      APPLICATION_VND_SEALED_MHT,
      APPLICATION_VND_SEALED_PPT,
      APPLICATION_VND_SEALED_XLS,
      APPLICATION_VND_SEEMAIL,
      APPLICATION_VND_SMAF,
      APPLICATION_VND_STARDIVISION_CALC,
      APPLICATION_VND_STARDIVISION_CHART,
      APPLICATION_VND_STARDIVISION_DRAW,
      APPLICATION_VND_STARDIVISION_IMPRESS,
      APPLICATION_VND_STARDIVISION_MATH,
      APPLICATION_VND_STARDIVISION_WRITER,
      APPLICATION_VND_STARDIVISION_WRITER_GLOBAL,
      APPLICATION_VND_SUN_XML_CALC,
      APPLICATION_VND_SUN_XML_CALC_TEMPLATE,
      APPLICATION_VND_SUN_XML_DRAW,
      APPLICATION_VND_SUN_XML_DRAW_TEMPLATE,
      APPLICATION_VND_SUN_XML_IMPRESS,
      APPLICATION_VND_SUN_XML_IMPRESS_TEMPLATE,
      APPLICATION_VND_SUN_XML_MATH,
      APPLICATION_VND_SUN_XML_WRITER,
      APPLICATION_VND_SUN_XML_WRITER_GLOBAL,
      APPLICATION_VND_SUN_XML_WRITER_TEMPLATE,
      APPLICATION_VND_SUS_CALENDAR,
      APPLICATION_VND_VIDSOFT_VIDCONFERENCE,
      APPLICATION_VND_VISIO,
      APPLICATION_VND_VISIONARY,
      APPLICATION_VND_WAP_SIC,
      APPLICATION_VND_WAP_SLC,
      APPLICATION_VND_WAP_WBXML,
      APPLICATION_VND_WAP_WMLC,
      APPLICATION_VND_WAP_WMLSCRIPTC,
      APPLICATION_VND_WEBTURBO,
      APPLICATION_VND_WORDPERFECT,
      APPLICATION_VND_WQD,
      APPLICATION_VND_WV_CSP_WBXML,
      APPLICATION_VND_YAMAHA_HV_DIC,
      APPLICATION_VND_YAMAHA_HV_SCRIPT,
      APPLICATION_VND_YAMAHA_HV_VOICE,
      APPLICATION_VND_YAMAHA_SMAF_AUDIO,
      APPLICATION_VND_YAMAHA_SMAF_PHRASE,
      APPLICATION_WATCHERINFO_XML,
      APPLICATION_WORD,
      APPLICATION_WORDPERFECT,
      APPLICATION_WORDPERFECT5_1,
      APPLICATION_WORDPERFECT6_1,
      APPLICATION_WORDPERFECTD,
      APPLICATION_XHTML_XML,
      APPLICATION_XML,
      APPLICATION_XML_DTD,
      APPLICATION_XSLT_XML,
      APPLICATION_X_123,
      APPLICATION_X_ACCESS,
      APPLICATION_X_BCPIO,
      APPLICATION_X_BLEEPER,
      APPLICATION_X_BZIP2,
      APPLICATION_X_CDLINK,
      APPLICATION_X_CHESS_PGN,
      APPLICATION_X_COMPRESS,
      APPLICATION_X_COMPRESSED,
      APPLICATION_X_CPIO,
      APPLICATION_X_CSH,
      APPLICATION_X_CU_SEEME,
      APPLICATION_X_DEBIAN_PACKAGE,
      APPLICATION_X_DIRECTOR,
      APPLICATION_X_DVI,
      APPLICATION_X_FUTURESPLASH,
      APPLICATION_X_GTAR,
      APPLICATION_X_GZIP,
      APPLICATION_X_HDF,
      APPLICATION_X_HEP,
      APPLICATION_X_HTML_RUBY,
      APPLICATION_X_HTTPD_PHP,
      APPLICATION_X_ICA,
      APPLICATION_X_IMAGEMAP,
      APPLICATION_X_JAVASCRIPT,
      APPLICATION_X_JAVA_ARCHIVE,
      APPLICATION_X_JAVA_JNLP_FILE,
      APPLICATION_X_JAVA_SERIALIZED_OBJECT,
      APPLICATION_X_JAVA_VM,
      APPLICATION_X_KOAN,
      APPLICATION_X_LATEX,
      APPLICATION_X_LOTUS_123,
      APPLICATION_X_MAC,
      APPLICATION_X_MACBASE64,
      APPLICATION_X_MAC_COMPACTPRO,
      APPLICATION_X_MAKER,
      APPLICATION_X_MATHCAD,
      APPLICATION_X_MIF,
      APPLICATION_X_MSACCESS,
      APPLICATION_X_MSDOS_PROGRAM,
      APPLICATION_X_MSDOWNLOAD,
      APPLICATION_X_MSWORD,
      APPLICATION_X_MS_WMD,
      APPLICATION_X_MS_WMZ,
      APPLICATION_X_NETCDF,
      APPLICATION_X_NS_PROXY_AUTOCONFIG,
      APPLICATION_X_PAGEMAKER,
      APPLICATION_X_PERL,
      APPLICATION_X_PYTHON,
      APPLICATION_X_QUICKTIMEPLAYER,
      APPLICATION_X_RAR_COMPRESSED,
      APPLICATION_X_RTF,
      APPLICATION_X_RUBY,
      APPLICATION_X_SH,
      APPLICATION_X_SHAR,
      APPLICATION_X_SHOCKWAVE_FLASH,
      APPLICATION_X_SPSS,
      APPLICATION_X_STUFFIT,
      APPLICATION_X_SV4CPIO,
      APPLICATION_X_SV4CRC,
      APPLICATION_X_TAR,
      APPLICATION_X_TCL,
      APPLICATION_X_TEX,
      APPLICATION_X_TEXINFO,
      APPLICATION_X_TOOLBOOK,
      APPLICATION_X_TROFF,
      APPLICATION_X_TROFF_MAN,
      APPLICATION_X_TROFF_ME,
      APPLICATION_X_TROFF_MS,
      APPLICATION_X_USTAR,
      APPLICATION_X_VMSBACKUP,
      APPLICATION_X_WAIS_SOURCE,
      APPLICATION_X_WINGZ,
      APPLICATION_X_WORD,
      APPLICATION_X_WORDPERFECT,
      APPLICATION_X_WORDPERFECT6_1,
      APPLICATION_X_WORDPERFECTD,
      APPLICATION_X_X509_CA_CERT,
      APPLICATION_ZIP,
      AUDIO_AMR,
      AUDIO_AMR_WB,
      AUDIO_BASIC,
      AUDIO_EVRC,
      AUDIO_L16,
      AUDIO_MP4,
      AUDIO_MPEG,
      AUDIO_SMV,
      AUDIO_VND_DIGITAL_WINDS,
      AUDIO_VND_EVERAD_PLJ,
      AUDIO_VND_LUCENT_VOICE,
      AUDIO_VND_NOKIA_MOBILE_XMF,
      AUDIO_VND_NORTEL_VBK,
      AUDIO_VND_NUERA_ECELP4800,
      AUDIO_VND_NUERA_ECELP7470,
      AUDIO_VND_NUERA_ECELP9600,
      AUDIO_VND_QCELP,
      AUDIO_VND_SEALEDMEDIA_SOFTSEAL_MPEG,
      AUDIO_X_AAC,
      AUDIO_X_AIFF,
      AUDIO_X_MIDI,
      AUDIO_X_MS_WAX,
      AUDIO_X_MS_WMA,
      AUDIO_X_MS_WMV,
      AUDIO_X_PN_REALAUDIO,
      AUDIO_X_PN_REALAUDIO_PLUGIN,
      AUDIO_X_REALAUDIO,
      AUDIO_X_WAV,
      CHEMICAL_X_PDB,
      CHEMICAL_X_XYZ,
      DRAWING_DWF,
      IMAGE_BMP,
      IMAGE_GIF,
      IMAGE_IEF,
      IMAGE_JP2,
      IMAGE_JPEG,
      IMAGE_JPM,
      IMAGE_JPX,
      IMAGE_PNG,
      IMAGE_SVG_XML,
      IMAGE_TARGA,
      IMAGE_TIFF,
      IMAGE_VND_DGN,
      IMAGE_VND_DJVU,
      IMAGE_VND_DWG,
      IMAGE_VND_GLOBALGRAPHICS_PGB,
      IMAGE_VND_MICROSOFT_ICON,
      IMAGE_VND_MS_MODI,
      IMAGE_X_BMP,
      IMAGE_X_CMU_RASTER,
      IMAGE_X_PAINTSHOPPRO,
      IMAGE_X_PORTABLE_ANYMAP,
      IMAGE_X_PORTABLE_BITMAP,
      IMAGE_X_PORTABLE_GRAYMAP,
      IMAGE_X_PORTABLE_PIXMAP,
      IMAGE_X_RGB,
      IMAGE_X_TARGA,
      IMAGE_X_VND_DGN,
      IMAGE_X_XBITMAP,
      IMAGE_X_XBM,
      IMAGE_X_XPIXMAP,
      IMAGE_X_XWINDOWDUMP,
      MESSAGE_RFC822,
      MODEL_IGES,
      MODEL_MESH,
      MODEL_VND_PARASOLID_TRANSMIT_BINARY,
      MODEL_VND_PARASOLID_TRANSMIT_TEXT,
      MODEL_VRML,
      TEXT_COMMA_SEPARATED_VALUES,
      TEXT_CSS,
      TEXT_CSV,
      TEXT_HTML,
      TEXT_PLAIN,
      TEXT_PRS_FALLENSTEIN_RST,
      TEXT_RICHTEXT,
      TEXT_RTF,
      TEXT_SGML,
      TEXT_TAB_SEPARATED_VALUES,
      TEXT_TROFF,
      TEXT_VND_NET2PHONE_COMMCENTER_COMMAND,
      TEXT_VND_SUN_J2ME_APP_DESCRIPTOR,
      TEXT_VND_WAP_SI,
      TEXT_VND_WAP_SL,
      TEXT_VND_WAP_WML,
      TEXT_VND_WAP_WMLSCRIPT,
      TEXT_XML,
      TEXT_X_COMPONENT,
      TEXT_X_RTF,
      TEXT_X_SETEXT,
      TEXT_X_VCALENDAR,
      TEXT_X_VCARD,
      TEXT_X_YAML,
      VIDEO_3GPP,
      VIDEO_DL,
      VIDEO_GL,
      VIDEO_MJ2,
      VIDEO_MP4,
      VIDEO_MPEG,
      VIDEO_OGG,
      VIDEO_QUICKTIME,
      VIDEO_VND_MPEGURL,
      VIDEO_VND_NOKIA_INTERLEAVED_MULTIMEDIA,
      VIDEO_VND_OBJECTVIDEO,
      VIDEO_VND_SEALEDMEDIA_SOFTSEAL_MOV,
      VIDEO_VND_SEALED_MPEG1,
      VIDEO_VND_SEALED_MPEG4,
      VIDEO_VND_SEALED_SWF,
      VIDEO_VND_VIVO,
      VIDEO_X_DL,
      VIDEO_X_FLI,
      VIDEO_X_FLV,
      VIDEO_X_GL,
      VIDEO_X_MSVIDEO,
      VIDEO_X_MS_ASF,
      VIDEO_X_MS_WM,
      VIDEO_X_MS_WMV,
      VIDEO_X_MS_WMX,
      VIDEO_X_MS_WVX,
      VIDEO_X_SGI_MOVIE,
      X_CHEMICAL_X_PDB,
      X_CHEMICAL_X_XYZ,
      X_CONFERENCE_X_COOLTALK,
      X_DRAWING_DWF,
      X_WORLD_X_VRML
    };

    struct type {
      std::string name;
      int value;
    };

    class mime : public ::Singleton<lhs::http::mime> {
      friend class ::Singleton<lhs::http::mime>;

      public:
        mime();

        std::vector< std::pair<std::string, mime_type_value> > operator[](std::string extension);
        void add_custom_type(std::string extension, std::string name);

        static std::vector< std::pair<std::string, mime_type_value> > types_for_extensions(std::string extension);
        static void new_type(std::string extension, std::string name);

      private:
        std::map<std::string, std::vector< std::pair<std::string, mime_type_value> > > mime_types; /*!< MIME/Types map */ 
        int custom_type;
    };

    /*!
     * \class mime_type
     * \brief MIME/Type informations
     */
    class mime_type {
      public:
        mime_type(std::string ext);
        bool operator==(mime_type mt);
        bool operator!=(mime_type mt);
        type operator[](int i);

      private:
        bool has(type t);

      public:
        std::string extension;
        std::vector<type> types;
    };
  }
}

#endif
